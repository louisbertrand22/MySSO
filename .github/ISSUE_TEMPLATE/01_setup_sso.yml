name: "üöÄ Setup base architecture for custom SSO"
description: "Initialize the OAuth2 + OpenID Connect authorization server project structure"
title: "Setup base architecture for custom SSO"
labels: ["setup", "sso", "auth", "enhancement"]
assignees: ["github-copilot"]
body:
  - type: markdown
    attributes:
      value: |
        ## üß† Contexte
        Je veux construire mon propre **SSO (Single Sign-On)** moderne pour mes applications.

        Ce SSO doit √™tre un **serveur d‚Äôautorisation OAuth2 + OpenID Connect** complet, capable d‚Äô√©mettre des **JWT tokens**, de g√©rer des **utilisateurs, clients, refresh tokens**, et de respecter les standards :
        - RFC 6749 (OAuth 2.0)
        - RFC 8414 (Authorization Server Metadata)
        - RFC 8252 (OAuth 2.0 for Native Apps)
        - RFC 9068 (JWT Access Tokens)

  - type: markdown
    attributes:
      value: |
        ## ‚öôÔ∏è Stack technique
        - **Langage :** Node.js (TypeScript)  
        - **Framework :** Express.js  
        - **Base de donn√©es :** PostgreSQL (via Prisma ORM)  
        - **Hashing :** Argon2id  
        - **JWT :** RS256 (cl√©s asym√©triques)  
        - **Tests :** Vitest  
        - **Config :** dotenv  
        - **Lint/Format :** ESLint + Prettier  

  - type: textarea
    id: goal
    attributes:
      label: üéØ Objectif de cette √©tape
      value: |
        Cr√©er la **base du projet** :
        1. Structure du repo (`src/`, `prisma/`, `config/`, `routes/`, `controllers/`, `services/`)
        2. Serveur Express pr√™t √† lancer (port configurable)
        3. Endpoint `/health` pour v√©rifier le bon fonctionnement
        4. G√©n√©ration et stockage local de cl√©s RSA (`/keys/jwks.json`)
        5. Sch√©ma Prisma avec tables :
           - `User`
           - `Client`
           - `AuthCode`
           - `RefreshToken`
        6. Hashing de mot de passe (Argon2id)
        7. G√©n√©ration d‚Äôun JWT de test (RS256)
        8. Pr√©paration des routes vides :
           - `/.well-known/openid-configuration`
           - `/authorize`
           - `/token`
           - `/userinfo`
           - `/jwks.json`

  - type: textarea
    id: details
    attributes:
      label: ‚öôÔ∏è D√©tails de mise en ≈ìuvre
      value: |
        - Respecter les sp√©cifications OpenID Connect et OAuth2.  
        - Utiliser TypeScript avec typage strict.  
        - D√©couper en contr√¥leurs / services / mod√®les / middlewares.  
        - Pr√©parer une structure extensible (MFA, consent screen, admin UI).  
        - Inclure un script `npm run dev` (nodemon).  
        - Inclure un `README` expliquant le lancement.  

  - type: textarea
    id: steps
    attributes:
      label: üí° √âtapes attendues de Copilot
      value: |
        - G√©n√©rer `src/server.ts` ‚Üí serveur Express + routes  
        - G√©n√©rer `src/config/env.ts` ‚Üí lecture `.env`  
        - G√©n√©rer `prisma/schema.prisma` avec les tables de base  
        - G√©n√©rer `src/services/jwtService.ts` ‚Üí signature/v√©rification des JWT  
        - G√©n√©rer `src/routes/authRoutes.ts` (routes vides : authorize/token/userinfo)  
        - G√©n√©rer `src/controllers/authController.ts` (placeholders)  
        - Script postinstall pour cr√©er les cl√©s RSA si absentes  
        - G√©n√©rer un `README.md` minimal (`npm install`, `npm run dev`, etc.)

  - type: markdown
    attributes:
      value: |
        ## ‚úÖ Deliverable attendu
        > Un squelette de projet Node/TypeScript fonctionnel avec un serveur Express minimal, Prisma configur√©, cl√©s JWT g√©n√©r√©es, endpoints placeholders, et une base pr√™te pour √©tendre les flows OAuth2 / OpenID Connect.
